<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.7.2"><meta name="generator" content="Jekyll v4.2.0" /><meta property="og:title" content="Deep dive into modern application" /><meta name="author" content="Francois LEON" /><meta property="og:locale" content="en_US" /><meta name="description" content="Introduction" /><meta property="og:description" content="Introduction" /><link rel="canonical" href="https://scomnewbie.github.io//posts/registrationvsenterpriseapp/" /><meta property="og:url" content="https://scomnewbie.github.io//posts/registrationvsenterpriseapp/" /><meta property="og:site_name" content="SCOMnewbie learnings" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-08T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Deep dive into modern application" /><meta name="twitter:site" content="@fanfleon" /><meta name="twitter:creator" content="@Francois LEON" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"Francois LEON"},"description":"Introduction","url":"https://scomnewbie.github.io//posts/registrationvsenterpriseapp/","@type":"BlogPosting","headline":"Deep dive into modern application","dateModified":"2021-02-08T22:37:34+01:00","datePublished":"2021-02-08T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://scomnewbie.github.io//posts/registrationvsenterpriseapp/"},"@context":"https://schema.org"}</script><title>Deep dive into modern application | SCOMnewbie learnings</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" href="/assets/css/post.css" as="style"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-7JY58BKWDR"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-7JY58BKWDR'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/cotes2020/chirpy-images/commons/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">SCOMnewbie learnings</a></div><div class="site-subtitle font-italic">A text-focused Jekyll theme</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tabs/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tabs/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/tabs/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/tabs/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/SCOMnewbie" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/fanfleon" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['francois.leon','hotmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Deep dive into modern application</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Deep dive into modern application</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 8, 2021, 12:00 AM +0100" > Feb 8 <i class="unloaded">2021-02-08T00:00:00+01:00</i> </span> by <span class="author"> Francois LEON </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Feb 8, 2021, 10:37 PM +0100" > Feb 8 <i class="unloaded">2021-02-08T22:37:34+01:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3028 words">16 min</span></div></div><div class="post-content"><h1 id="introduction">Introduction</h1><p>At the beginning, I’ve wanted to talk about what an application is and how to create it in a single article. Then I’ve started to realize that it’s maybe not a good idea… So, let’s start by explaining the differences between an enterprise app and an app registration and then let’s go deeper in this subject.</p><p>The goal of this article will be to explain:</p><ul><li>The difference between app registration and enterprise app<li>What single tenant vs multi-tenant means?<li>What consent is and why we have to consider it seriously?<li>Tips around modern authentication governance</ul><h1 id="app-registration-vs-enterprise-app">App registration Vs Enterprise app</h1><p>I can’t count the number of times developers/admins tell me that Microsoft has no idea of what they’re doing regarding this topic. “Why they’ve decided to split the two?”, “Why do we have the same information in both pages?”, “If the clientID is the same, it means this is the same thing no?” and I can continue with few others… Now usually my answer starts with something like this “You’re right, I think you get an idea here. Maybe you should start creating your own Identity Provider and compete this gigantic billionaire company which has no idea of what they’re doing…”. <strong>Most of the time</strong>, the person in front of me understands it’s sarcastic. Now even if there is a reason, I must admit that not obvious when you start.</p><h2 id="app-registration">App registration</h2><p>An <strong>app registration</strong> is literally the <strong>definition of the application you’re developing</strong>. This is what you register to your identity provider to get the globally <strong>unique Client ID</strong> (also called app ID) into your personal tenant but also in fact <strong>between all tenants</strong> in general (more information later with multi-tenant application).</p><p>Within the app registration, you will be able to:</p><ul><li><strong>Configure secrets/certificates</strong>. As scripters, we usually only use this part to execute our non-interactive scripts as an application.<li>Define if it’s a <strong>single or a multi-tenant</strong> application. Do you want your globally unique app available from other AAD tenants?<li>Configure the <strong>permissions (scopes)</strong> your application will require. Your application may need to use graph API, a storage account, a custom API in the backend…<li>Configure the <strong>claim configuration</strong>. Does your application need for example the caller’s IP address in the <strong>client ID token</strong>? The list of all groups the user belongs to maybe?<li>Configure if it’s a <strong>public or a confidential application</strong> and <strong>which OAUTH flows are authorized</strong>. As we’ve seen before, this concept of public/confidential is important. We will discuss more about this topic in future article. But again, don’t store secrets in a native application (Desktop app, SPA, mobile app).<li>Define <strong>roles your application will expose</strong> in the client ID token. If you need to split admin and normal users, you can define roles through the manifest.<li><strong>Expose API</strong>. For example, if you plan to use the delegated permission (on behalf of user right), you will have to expose the <strong>user_impersonation permission</strong> (can be another name if you need).<li>Configure if you, as a developer are a <strong>verified publisher</strong>! This is an important point when you plan to do multi-tenant application (see later for more information).<li>And few other properties</ul><p>As you can see, the app registration is not just a place you use to generate your secrets for your clientID. <strong>This part has a real impact on how your application will behave, how your application is secured and what your application can do. This is where your developer should spend most of his time</strong>.</p><div class="alert alert-danger" role="alert"><i class="fa fa-exclamation-circle"></i> <b>Warning:</b> <strong>An app registration is a one to many AAD tenants relationship</strong>. Keep in mind that you don’t have an AZ CLI/Powershell app registration in your tenant, only Microsoft has.</div><h2 id="enterprise-app">Enterprise App</h2><p>An enterprise app, or service principal (SP), is a <strong>local tenant representation of an app registration</strong>. The SP reference an app registration which has been declared within the local tenant or in a remote one (multi-tenant app). For scripters, this is what you’re using when you do your az login with the potential secret/certificate that you have to rotate (You rotate it right? I’m sure you don’t tick the never expire 😊). Then Microsoft proposes a service called <strong>Managed service Identity (MSI)</strong> which is basically a <strong>service principal in the backend, but they oversee secrets rotation</strong>.</p><p>Within the enterprise application, you will be able to:</p><ul><li><strong>Manage who can access your application in your tenant</strong>. You will have to be authenticated to use this application, so you can decide who can use it or not with user or group assignment.<li><strong>Monitore who access</strong> your application. “Every” (except client credential flow?) sign-ins are tracked and can be filtered or exported from the portal.<li><strong>Monitore</strong> who gave their <strong>consents</strong> to your application on which specific scope.<li>Configure <strong>conditional access</strong>.<li>And other functionalities like configure SSO, Provisioning, …</ul><p>As you can see, enterprise app and app registration aren’t the same. <strong>IT teams usually take care of the Enterprise app</strong> because it’s more <strong>management-oriented</strong> compare to app registration (dev oriented).</p><div class="alert alert-danger" role="alert"><i class="fa fa-exclamation-circle"></i> <b>Warning:</b> <strong>An enterprise app is a many to one relationship</strong>. We’ve seen there is only one app registration for multiple service principals.</div><h1 id="single-tenant-vs-multi-tenant-application">Single-tenant Vs multi-tenant application</h1><p>Let’s start with a multi-tenant picture:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2021-02-08/singlemultitenant.png" alt="registrationvsenterpriseapp 01" /></p><p>To clarify this picture, as a customer, there no security concerns with the multi-tenant app if you read and agree the requested scopes (see danger section below). In other words, it’s not because your SP reference an app registration located in another tenant that you or they will be able to access data located in your/their subscription. This is the feature that delegated permission brings on the table.</p><div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> Rule of thumb: Just create single tenant application if you don’t have multiple tenants to manage. Doing this your employees and guest accounts (B2B) will be able to access it and you’re improving your security posture without any effort. In addition, it’s simple to implement infrastructure tests on this parameter as monitoring.</div><p>Without going too deep, <strong>Open ID Connect (OIDC)</strong> is a layer on top of <strong>OAUTH2.0</strong> which give you an <strong>Id token</strong> in addition of the <strong>Access/Refresh token</strong> you already have with OAUTH2.0. Both are Authentication/Authorization protocols that we consume through different connection flows (more information later). Today we should use something called the <strong>V2.0 endpoint</strong> which give you all the latest features the identity platform can offer. In short what does it means:</p><p>For <strong>single tenant app</strong>, you should hit (or hardcode if you prefer) the endpoint https://login.microsoftonline.com/<strong>‘Tenant Id or tenant Name’</strong>/oauth2/<strong>v2.0</strong>/authorize and for a <strong>multi-tenant app</strong> https://login.microsoftonline.com/<strong>common</strong>/oauth2/<strong>v2.0</strong>/authorize. As you can imagine for a multi-tenant app, you specify the common magic word, and let the platform find the right tenant for you.</p><div class="alert alert-danger" role="alert"><i class="fa fa-exclamation-circle"></i> <b>Warning:</b> Important: Imagine you want to provide an app to <strong>only few tenants</strong>, you will have to <strong>handle it from your app itself</strong>. Basically, in the ID token you will receive, if it’s not “allowed” drop the query.</div><div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> Microsoft does not recommend decoding the Access token (AT) in your application but the ID Token instead. An AT is design to grant access to an application and shouldn’t be touched. Microsoft explain that “tomorrow”, they can encrypt this token with more than a base64 encryption.</div><h1 id="consent">Consent</h1><p>For me, <strong>consent is one of the most underestimated part</strong> of the puzzle. I’ve seen global admins/App admins who click the grant admin consent button without really understand what they’re doing. And on the end user side, I’ve seen clients who click on the consent button without even taking 2 seconds to read what they consented to … <strong>But scary things can happen if you don’t take consent seriously</strong> (see below).</p><p>Here how I explain consent flow to a non-technical person. When you install a GPS related application on your smartphone, the phone asks you if you’re OK the app use your GPS chipset to work correctly. If you say yes, the app won’t bother you again. Here it’s the same thing with scopes instead of GPS. When AAD ask you (the user) to consent, AAD will take note you’ve consented and won’t bother you again. You can see who’s consented to what when you check the Service Principal.</p><p>You have two types of consent:</p><ul><li><strong>User consent</strong> (like your smartphone) where each user has to do a manual action to consent scopes.<li><strong>Admin consent</strong> which is where an admin give <strong>consent on behalf of all the organization</strong> users. In other words, users won’t receive any prompts, it’s already consented for them.</ul><p>But who can give admin consent?</p><ul><li><strong>Global admin</strong> which we can be translated to <strong>god access</strong>. A GA can do anything, like giving admin consent on any scopes for all users or take control back on any tenant’s subscription. This is the domain admins group attackers try to get in the “old” AD days.<li><strong>Application administrator</strong> which can do almost everything on app registration and enterprise app <strong>except to admin consent Microsoft graph audience</strong>. But an app admin can consent an api exposed by another app which already received admin consent by a GA. This is this RBAC is <strong>considered as a high privilege role</strong>.</ul><div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> In certain cases, you want to be alerted when a RBAC event is generated on your subscription (e.g: A GA who decided to look at your sub). You can use this <a href="https://github.com/SCOMnewbie/Azure/tree/master/LogicApp/RBAC-Warnings">logic app</a> to be alerted.</div><h1 id="demo">Demo</h1><p>Let’s “hack” a tenant!</p><p>In this demo, we will have 2 tenants. One which belongs to the attacker (full access) and the other one which belongs to your company (will be GA in this demo, but I’m pretty sure worked well is your consent policy was broken). Thanks to Microsoft this “breach” has been mitigated for AAD few months ago, but this pattern can sadly be reuse in other IDPs.. I will use the portal to show you what I’ve done, in the next article, we will have some fun to create applications with code.</p><p>We will build this:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2021-02-08/hack_oauth.png" alt="hack oauth 01" /></p><p>First let’s go on the attacker tenant (we have full access) and create a new multi-tenant app registration called <strong>I will pwn you</strong>. Then give it <strong>application mail.read</strong> (This scope give full access to read all mailboxes). Finally, let’s <strong>generate a secret</strong> for this app. You should have something like this:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2021-02-08/hack_oauth_02.png" alt="hack oauth 02" /></p><p>At this point, the attacker just configure within his own tenant an application which can read email. This is a dummy example, but it can be “far more critical” like manage directory, write groups,…). For this demo, I will use a pretty cool PS module called <strong>MSAL.PS</strong>. It’s not an official Powershell SDK, but it helps you to generate token using MSAL. Let’s now quickly test if our app is working:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="c">#Define parameters</span><span class="w">
</span><span class="nv">$tenantId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&lt;</span><span class="n">Attacker</span><span class="w"> </span><span class="nx">tenantId</span><span class="err">&gt;</span><span class="w">
</span><span class="nv">$AppId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&lt;</span><span class="n">attacker</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="nx">registration</span><span class="w"> </span><span class="nx">Id</span><span class="err">&gt;</span><span class="w">
</span><span class="nv">$Secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Read-Host</span><span class="w"> </span><span class="nt">-AsSecureString</span><span class="w"> </span><span class="c">#secret generated previously</span><span class="w">
</span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"An attacker email address"</span><span class="w">

</span><span class="c">#Create variables</span><span class="w">
</span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/v1.0/users/</span><span class="nv">$UPN</span><span class="s2">/messages"</span><span class="w">
</span><span class="c">#Generate Access token for a confidential app</span><span class="w">
</span><span class="nv">$token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-MsalToken</span><span class="w"> </span><span class="nt">-ClientId</span><span class="w"> </span><span class="nv">$appId</span><span class="w"> </span><span class="nt">-ClientSecret</span><span class="w"> </span><span class="nv">$secret</span><span class="w"> </span><span class="nt">-TenantId</span><span class="w"> </span><span class="nv">$tenant</span><span class="w"> </span><span class="nt">-Scopes</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/.default"</span><span class="w"> </span><span class="nt">-ForceRefresh</span><span class="w">
</span><span class="c">#Create header</span><span class="w">
</span><span class="nv">$Headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="s1">'Authorization'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$(</span><span class="s2">"Bearer "</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="nv">$token</span><span class="err">.</span><span class="nx">AccessToken</span><span class="err">)</span><span class="w">
    </span><span class="s2">"Content-Type"</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'application/json'</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c">#Request read email</span><span class="w">
</span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$Headers</span><span class="w">

</span></pre></table></code></div></div><p>Now you should be able to read any mailboxes from the attacker tenant, <strong>which is normal</strong> because you run your workflow using an <strong>application permission</strong> (run as an app, not as a user).</p><p>Now this is the <strong>interesting part</strong>. Imagine now, the attacker starts a phishing attack on your company and a basic user click on a web link (nice looking app with 365 Microsoft icons) and arrive at the AAD authentication page. For this demo, instead of creating a webpage for the phishing attack, we will simply generate a <strong>device code authentication</strong> (public application with no secret shared) using the attacker AppId from the end user. The result is the same, it’s just I have no idea how to create a fake HTML page :D. <strong>Now we’re on the basic user side</strong>, let’s run:</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="c">#Define parameters</span><span class="w">
</span><span class="nv">$tenantId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&lt;</span><span class="n">Customer</span><span class="w"> </span><span class="nx">tenantId</span><span class="err">&gt;</span><span class="w">
</span><span class="nv">$AppId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&lt;</span><span class="n">attacker</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="nx">registration</span><span class="w"> </span><span class="nx">Id</span><span class="err">&gt;</span><span class="w">
</span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"A customer email address"</span><span class="w">

</span><span class="c">#Generate Access token for an public app</span><span class="w">
</span><span class="nv">$token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-MsalToken</span><span class="w"> </span><span class="nt">-ClientId</span><span class="w"> </span><span class="nv">$appId</span><span class="w"> </span><span class="nt">-TenantId</span><span class="w"> </span><span class="nv">$tenant</span><span class="w"> </span><span class="nt">-devicecode</span><span class="w">
</span><span class="c">#Create header</span><span class="w">
</span><span class="nv">$Headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="s1">'Authorization'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$(</span><span class="s2">"Bearer "</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="nv">$token</span><span class="err">.</span><span class="nx">AccessToken</span><span class="err">)</span><span class="w">
    </span><span class="s2">"Content-Type"</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'application/json'</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c">#Request read email</span><span class="w">
</span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$Headers</span><span class="w">

</span></pre></table></code></div></div><p>Once you’ve entered the basic user credential, you should see something like this:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2021-02-08/hack_oauth_03.png" alt="hack oauth 03" /></p><p>And this is where we can send a <strong>BIG THANK YOU to Microsoft</strong>. Even if a basic end user can consent every application, MS required the application to be published. It’s not a silver bullet, but at least the attack requires more work than just a dummy phishing HTML page (more information below). Now instead of a basic user, let’s use a GA account from the customer side to continue the simulation. I’m pretty sure some IDPs didn’t fix this attack yet. Let’s imagine we’re still our basic user, but for the purpose of this demo, let’s use a GA instead, you should now see:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2021-02-08/hack_oauth_04.png" alt="hack oauth 04" /></p><p>Here it’s obvious, but let’s now imagine a good phishing attack with a good logo, a real company name and an application called Outlook… If user does not read the scope and consent, this is where the fun begins! Let’s click accept :D.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2021-02-08/hack_oauth_05.png" alt="hack oauth 05" /></p><p><strong>The user has now signed in. We don’t really care what happen now on the app side, it’s game over.</strong> Let’s go back on the attacker side and see what we can do now!</p><div class="language-powershell highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="w">
</span><span class="c">#Define parameters</span><span class="w">
</span><span class="nv">$tenantId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&lt;</span><span class="n">Customer</span><span class="w"> </span><span class="nx">tenantId</span><span class="err">&gt;</span><span class="w"> </span><span class="c">#&lt;---- From attacker side to customer tenant !!!</span><span class="w">
</span><span class="nv">$AppId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&lt;</span><span class="n">attacker</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="nx">registration</span><span class="w"> </span><span class="nx">Id</span><span class="err">&gt;</span><span class="w">
</span><span class="c">#Mandatory to run the script with application permission</span><span class="w">
</span><span class="nv">$Secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Read-Host</span><span class="w"> </span><span class="nt">-AsSecureString</span><span class="w"> </span><span class="c">#secret generated previously</span><span class="w">
</span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"A customer email address"</span><span class="w">

</span><span class="c">#Create variables</span><span class="w">
</span><span class="nv">$uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/v1.0/users/</span><span class="nv">$UPN</span><span class="s2">/messages"</span><span class="w">
</span><span class="c">#Generate Access token for an confidential app</span><span class="w">
</span><span class="nv">$token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get-MsalToken</span><span class="w"> </span><span class="nt">-ClientId</span><span class="w"> </span><span class="nv">$appId</span><span class="w"> </span><span class="nt">-ClientSecret</span><span class="w"> </span><span class="nv">$secret</span><span class="w"> </span><span class="nt">-TenantId</span><span class="w"> </span><span class="nv">$tenant</span><span class="w"> </span><span class="nt">-Scopes</span><span class="w"> </span><span class="s2">"https://graph.microsoft.com/.default"</span><span class="w"> </span><span class="nt">-ForceRefresh</span><span class="w"> </span><span class="c"># .default means give me all scopes for this audience (V1.0 shortcut)</span><span class="w">
</span><span class="c">#Create header</span><span class="w">
</span><span class="nv">$Headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">@{</span><span class="w">
    </span><span class="s1">'Authorization'</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$(</span><span class="s2">"Bearer "</span><span class="w"> </span><span class="err">+</span><span class="w"> </span><span class="nv">$token</span><span class="err">.</span><span class="nx">AccessToken</span><span class="err">)</span><span class="w">
    </span><span class="s2">"Content-Type"</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s1">'application/json'</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="c">#Request read email</span><span class="w">
</span><span class="n">Invoke-RestMethod</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$uri</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="nv">$Headers</span><span class="w">

</span></pre></table></code></div></div><p>Now, <strong>the attacker has access to your tenant and can read the entire company’s emails</strong>. And just to fully understand, now we access the company information with a service principal, so <strong>we don’t care if a user has MFA, reset password or anything like that</strong>. We execute our flow through another context … If we now check the logs (spoiler alert: Scary part), we should see:</p><p><span style="color:red"><strong>Nothing . . .</strong></span> In fact, this is not true. We can see in the <strong>AAD audit log that my GA account had consented a new application</strong>, but when I read the mail from the attacker side (with the secret), <strong>I don’t see any logs from both the AAD and Enterprise app side</strong>. I assume (hope) that MCAS/Sentinel can provide something better…</p><p>To be honest, because I was super surprise that I didn’t catch any logs, I’ve decided this time to grant group creation instead of just read.mail. And except this, in the <strong>AAD audit logs</strong> (because I did a POST) I can’t find any logs either:</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/img/2021-02-08/hack_oauth_06.png" alt="hack oauth 06" /></p><div class="alert alert-warning" role="alert"><i class="fa fa-warning"></i> <b>Important:</b> Even with the new portal experience, the service principal sign-ins is empty … It seems that MS has some hard time to track client credential flow I guess. I hope this will change in a near future</div><p>As you can see, this attack is simple and rely on a <strong>light governance regarding consents policy</strong>. Scary don’t you think?</p><h1 id="tips">Tips</h1><p>Now we start to understand the big picture, what can we do?</p><ul><li><p><strong>Global admins have to be TRAINED</strong>! They have to understand all those concepts and be ready to challenge developers. Imagine a GA consent a scope like Group.ReadWrite.All (delete all groups with application permission), things can become bad quickly…</p><li><p><strong>Train your developers</strong>. From end user perspective, it’s not really a good experience when you receive a wall of scopes to consent at the first login. Developers should implement <strong>dynamic scopes</strong> in their application and should understand the <strong>principal of least privilege</strong>.</p><li><p><strong>All Enterprise applications have to be monitored</strong> to detect overprivileged consented scopes. As we’ve seen, monitoring sign-ins is not an option today, but monitoring the enterprise app scopes or the audit log when someone consent can be an option. You also have tools like the cloud app security portal or sentinel which can help you to improve your security posture.</p><li><p>Train your users to read what they consent is not a option (you can try lol). But AAD proposes few options to avoid making the consent experience too painful. You can really <strong>tweak end user consent options</strong> to avoid blocking the consent completely and generate frustration. Therefore, MS proposes some option like <strong>allowing user to self-consent if the publisher is trusted and if the scopes are allowed by the IT team</strong>. We can enable also the <strong>Admin workflow</strong> to help end user to request consent to a GA account through a simple button.</p></ul><h1 id="conclusion">Conclusion</h1><p>I think now you can admit that an app registration and an enterprise app aren’t same thing. Between this article and a previous one, you should now start to understand how it’s working. We will continue few topics in a later one, but the big part is done.</p><p><strong>Here few take away</strong> from this article:</p><ul><li>TRAINED your GA! It’s not normal a GA does not understand scopes concepts.<li>If you don’t plan to create multi-tenant app, stick to single and try to implement governance/monitoring.<li>Start implementing Enterprise app governance. It means implementing a governance (weekly review/standards) and monitoring with tools like cloud app security, Sentinel, Scripts, …<li>Consent is underrated, but super important. Make sure you have a proper governance around consents in place and a proper consent policy for your end users!</ul><p>See you in the next article where we should start to create applications with code!</p><h1 id="references">references</h1><p><a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/application-consent-experience">Consent</a></p><p><a href="https://4sysops.com/archives/the-risk-of-fake-oauth-apps-in-microsoft-365-and-azure/">Malicious OAuth application</a></p><p><a href="https://docs.microsoft.com/fr-fr/cloud-app-security/app-permission-policy">CASB</a></p><p><a href="https://4sysops.com/archives/the-risk-of-fake-oauth-apps-in-microsoft-365-and-azure/">Fake oauth apps</a></p><p><a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/single-and-multi-tenant-apps">single Vs multi tenant</a></p><p><a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-protocols-oidc">OIDC in AAD</a></p><p><a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent">Permission and consent</a></p><p><a href="https://youtu.be/tbu4CfzP25o">How to hack OAuth</a></p><p><a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-configure-publisher-domain">App publisher</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/identity/'>identity</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/identity/" class="post-tag no-text-decoration" >identity</a> <a href="/tags/powershell/" class="post-tag no-text-decoration" >Powershell</a> <a href="/tags/azuread/" class="post-tag no-text-decoration" >AzureAD</a> <a href="/tags/graph/" class="post-tag no-text-decoration" >Graph</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Deep dive into modern application - SCOMnewbie learnings&url=https://scomnewbie.github.io//posts/registrationvsenterpriseapp/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Deep dive into modern application - SCOMnewbie learnings&u=https://scomnewbie.github.io//posts/registrationvsenterpriseapp/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Deep dive into modern application - SCOMnewbie learnings&url=https://scomnewbie.github.io//posts/registrationvsenterpriseapp/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/usegraphapibatching/">Use Graph API batching to speed things up?</a><li><a href="/posts/adqueriesfromazure/">Execute AD queries protected by modern authentication from Azure without VPN</a><li><a href="/posts/createaadapplications/">Another way to create Azure AD applications</a><li><a href="/posts/passwordlesswitharc/">Passwordless deployment from anywhere with Azure ARC</a><li><a href="/posts/registrationvsenterpriseapp/">Deep dive into modern application</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/powershell/">Powershell</a> <a class="post-tag" href="/tags/identity/">identity</a> <a class="post-tag" href="/tags/aad/">AAD</a> <a class="post-tag" href="/tags/azuread/">AzureAD</a> <a class="post-tag" href="/tags/arc/">ARC</a> <a class="post-tag" href="/tags/cli/">CLI</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/devops/">Devops</a> <a class="post-tag" href="/tags/graph/">Graph</a> <a class="post-tag" href="/tags/graphapi/">GraphAPI</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/authenticatedazfunc/"><div class="card-body"> <span class="timeago small" > Feb 9 <i class="unloaded">2021-02-09T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How can I better protect my Azure functions with OAuth?</h3><div class="text-muted small"><p> Introduction Following a question from Stefan Stranger, it seems there is not a lot of documentation on the subject. The goal here will be to simply enable OAUth on top of an app service plan with...</p></div></div></a></div><div class="card"> <a href="/posts/roleswithazfunc/"><div class="card-body"> <span class="timeago small" > Feb 10 <i class="unloaded">2021-02-10T00:00:00+01:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Add roles to an Azure function?</h3><div class="text-muted small"><p> Introduction Following the previous post where I’ve enabled OAUth on an azure function with easy auth, few minutes after I had another idea… The problem? I have no idea if it’s stupid or if it’s a...</p></div></div></a></div><div class="card"> <a href="/posts/apiwithpode/"><div class="card-body"> <span class="timeago small" > Jul 7 <i class="unloaded">2021-07-07T00:00:00+02:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Build a Powershell API with Pode</h3><div class="text-muted small"><p> Introduction I’ve tried to explain previously how to secure a backend api where I’ve used Azure functions to demonstrate how to protect it, but what if we’re not on Azure? I know you can run the A...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/clivspowershellaccesstoken/" class="btn btn-outline-primary"><p>Compare get-access-token and Get-AzAccessToken</p></a> <a href="/posts/authenticatedazfunc/" class="btn btn-outline-primary"><p>How can I better protect my Azure functions with OAuth?</p></a></div></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2021 <a href="https://twitter.com/fanfleon">Francois LEON</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/powershell/">Powershell</a> <a class="post-tag" href="/tags/identity/">identity</a> <a class="post-tag" href="/tags/aad/">AAD</a> <a class="post-tag" href="/tags/azuread/">AzureAD</a> <a class="post-tag" href="/tags/arc/">ARC</a> <a class="post-tag" href="/tags/cli/">CLI</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/devops/">Devops</a> <a class="post-tag" href="/tags/graph/">Graph</a> <a class="post-tag" href="/tags/graphapi/">GraphAPI</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://scomnewbie.github.io/{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
